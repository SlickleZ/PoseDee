{"ast":null,"code":"/**\n * Sequence player.\n *\n * Example usage:\n * ```html\n * <lord-icon trigger=\"sequence\" sequence=\"state:intro-empty,play,state:hover-empty,play,state:morph-fill,play,state:morph-erase,play,state:intro-empty,delay:first:last:500,play:reverse\" src=\"/trash.json\"></lord-icon>\n * ```\n */\nexport class Sequence {\n  element;\n  targetElement;\n  player;\n  sequenceIndex = 0;\n  frameState = null;\n  frameDelayFirst = null;\n  frameDelayLast = null;\n  timer;\n  constructor(element, targetElement, player) {\n    this.element = element;\n    this.targetElement = targetElement;\n    this.player = player;\n  }\n  onReady() {\n    this.step();\n  }\n  onComplete() {\n    this.timer = setTimeout(() => {\n      this.timer = null;\n      this.frameDelayLast = null;\n      this.step();\n    }, this.frameDelayLast || 0);\n  }\n  onConnected() {}\n  onDisconnected() {\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n  }\n  step() {\n    const numberRegex = /^\\d*(\\.\\d+)?$/;\n    const steps = this.sequence.split(',');\n    const step = steps[this.sequenceIndex];\n    this.sequenceIndex++;\n    if (this.sequenceIndex >= steps.length) {\n      this.sequenceIndex = 0;\n    }\n    const [action, ...params] = step.split(':');\n    if (action === 'play') {\n      if (this.frameState) {\n        this.player.state = this.frameState;\n        this.frameState = null;\n      }\n      const hasReverse = params.includes('reverse');\n      if (hasReverse) {\n        this.player.goToLastFrame();\n        this.player.direction = -1;\n      } else {\n        this.player.goToFirstFrame();\n        this.player.direction = 1;\n      }\n      this.timer = setTimeout(() => {\n        this.timer = null;\n        this.frameDelayFirst = null;\n        this.player.play();\n      }, this.frameDelayFirst || 0);\n    } else if (action === 'frame') {\n      let frameIndex = 0;\n      if (params.length && params[0].match(numberRegex)) {\n        frameIndex = Math.max(0, Math.min(this.player.frames, +params[0]));\n      }\n      this.player.frame = frameIndex;\n      this.timer = setTimeout(() => {\n        this.timer = null;\n        this.frameDelayFirst = null;\n        this.step();\n      }, this.frameDelayFirst || 0);\n    } else if (action === 'state') {\n      this.frameState = params[0];\n      this.step();\n    } else if (action === 'delay') {\n      let value = null;\n      for (const param of params) {\n        if (param && param.match(numberRegex)) {\n          value = +param;\n        }\n      }\n      if (value && value > 0) {\n        if (params.includes('first') && params.includes('last')) {\n          this.frameDelayFirst = value;\n          this.frameDelayLast = value;\n        } else if (params.includes('first')) {\n          this.frameDelayFirst = value;\n        } else if (params.includes('last')) {\n          this.frameDelayLast = value;\n        } else {\n          this.frameDelayFirst = value;\n        }\n      }\n      this.step();\n    } else {\n      throw new Error(`Invalid sequence action: ${action}`);\n    }\n  }\n  get sequence() {\n    return this.element.getAttribute('sequence') || 'play';\n  }\n}","map":{"version":3,"names":["Sequence","element","targetElement","player","sequenceIndex","frameState","frameDelayFirst","frameDelayLast","timer","constructor","onReady","step","onComplete","setTimeout","onConnected","onDisconnected","clearTimeout","numberRegex","steps","sequence","split","length","action","params","state","hasReverse","includes","goToLastFrame","direction","goToFirstFrame","play","frameIndex","match","Math","max","min","frames","frame","value","param","Error","getAttribute"],"sources":["../../src/triggers/sequence.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}